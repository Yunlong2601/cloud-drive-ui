{% extends "base.html" %}

{% block title %}Dashboard - FortiFile{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-3">
    <h1>My Files</h1>
    <div>
        <span class="text-muted">Roles: </span>
        {% for role in user_roles %}
            <span class="badge badge-info">{{ role }}</span>
        {% endfor %}
        <a href="{{ url_for('upload') }}" class="btn btn-primary" style="margin-left: 15px;">Upload File</a>
    </div>
</div>

{% if files %}
<div class="file-grid">
    {% for file in files %}
    <div class="file-card">
        <h4>{{ file.original_filename }}</h4>
        <div class="file-meta">
            <div>Size: {{ (file.file_size / 1024)|round(1) }} KB</div>
            <div>Owner: {{ file.owner_name or 'Unknown' }}</div>
            <div>
                <span class="badge badge-{{ file.classification }}">{{ file.classification }}</span>
            </div>
        </div>
        <div class="file-actions">
            <a href="{{ url_for('download', file_id=file.id) }}" class="btn btn-primary btn-sm">Download</a>
            {% if file.owner_id == current_user.id %}
                <a href="{{ url_for('share', file_id=file.id) }}" class="btn btn-secondary btn-sm">Share</a>
                <form action="{{ url_for('delete_file', file_id=file.id) }}" method="POST" style="display: inline;" onsubmit="return confirm('Delete this file?');">
                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                </form>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card" style="text-align: center; padding: 40px;">
    <p class="text-muted">No files yet. <a href="{{ url_for('upload') }}">Upload your first file</a></p>
</div>
{% endif %}
{% endblock %}
